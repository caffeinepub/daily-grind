{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 11,
  "summary": "Building 'Daily Grind' — a daily workout reminder app with weekly workout schedule, today's workout view, mark-as-completed, motivational messages, progress tracking, and user authentication.",
  "architectural_notes": [
    "Three data tables: Workout Schedule, Motivation Messages, User",
    "Four main screens: Today, Schedule, Progress, Settings",
    "Tier progression: 22 tiers total (Dirt through Anti-matter), computed weekly based on schedule completion rate"
  ],
  "known_issues": [],
  "isFixRequest": false,
  "existing_features": [
    {
      "id": "feature-build-a-today-s-workout-screen-that-auto-matches-the-current-day-of-the-week-derived-from-the-client-s-local-date-to-the-user-s-workout-schedule-entry-for-that-day-display-the-workout-name-workout-details-and-time-reminder-include-a-mark-as-completed-button-that-updates-the-completed-status-for-that-entry-if-no-workout-is-scheduled-for-today-show-a-friendly-placeholder-message",
      "title": "Build a 'Today's Workout' screen that auto-matches the current day of the week (derived from the client's local date) to the user's workout schedule entry for that day. Display the workout name, workout details, and time reminder. Include a 'Mark as Completed ✅' button that updates the completed status for that entry. If no workout is scheduled for today, show a friendly placeholder message.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-build-a-schedule-screen-that-lists-all-7-days-of-the-week-with-their-assigned-workouts-allow-the-user-to-edit-each-day-s-workout-name-workout-details-and-time-reminder-inline-or-via-a-detail-edit-form-changes-should-persist-to-the-backend",
      "title": "Build a 'Schedule' screen that lists all 7 days of the week with their assigned workouts. Allow the user to edit each day's workout name, workout details, and time reminder inline or via a detail/edit form. Changes should persist to the backend.",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "feature-build-a-progress-screen-that-shows-total-workouts-completed-this-week-a-weekly-completion-streak-consecutive-days-with-completed-workouts-and-a-visual-progress-bar-or-indicator-showing-how-many-of-the-7-days-this-week-have-been-completed",
      "title": "Build a 'Progress' screen that shows: total workouts completed this week, a weekly completion streak (consecutive days with completed workouts), and a visual progress bar or indicator showing how many of the 7 days this week have been completed.",
      "reqIds": [
        "REQ-6"
      ],
      "version": 1
    },
    {
      "id": "feature-display-a-random-motivational-message-fetched-from-the-backend-prominently-on-the-today-s-workout-screen-or-as-a-dedicated-banner-card-visible-from-the-home-view",
      "title": "Display a random motivational message fetched from the backend prominently on the Today's Workout screen or as a dedicated banner/card visible from the home view.",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "feature-integrate-internet-identity-authentication-gate-all-workout-data-and-profile-features-behind-login-show-a-login-prompt-to-unauthenticated-users-after-login-load-the-user-s-personal-workout-schedule",
      "title": "Integrate Internet Identity authentication. Gate all workout data and profile features behind login. Show a login prompt to unauthenticated users. After login, load the user's personal workout schedule.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-apply-a-dark-high-energy-fitness-aesthetic-throughout-the-app-use-a-dark-charcoal-or-near-black-background-with-bold-accent-colors-e-g-fiery-orange-or-electric-green-strong-typography-and-a-clean-card-based-layout-the-visual-theme-should-feel-motivational-and-athletic-apply-it-consistently-across-all-screens",
      "title": "Apply a dark, high-energy fitness aesthetic throughout the app. Use a dark charcoal or near-black background with bold accent colors (e.g., fiery orange or electric green), strong typography, and a clean card-based layout. The visual theme should feel motivational and athletic. Apply it consistently across all screens.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "feature-create-a-settings-screen-accessible-from-the-app-navigation-display-the-user-s-current-tier-prominently-with-a-styled-tier-badge-tier-name-and-a-rank-icon-or-color-coded-visual-that-escalates-in-visual-intensity-as-the-tier-increases-show-the-weekly-completion-percentage-used-for-the-last-evaluation-and-the-advancement-thresholds-e-g-70-advance-40-hold-40-drop-include-a-evaluate-this-week-button-that-calls-evaluateandadvancetier-and-refreshes-the-displayed-tier-add-a-settings-link-to-the-app-s-navigation-bar-both-desktop-header-and-mobile-bottom-nav",
      "title": "Create a Settings screen accessible from the app navigation. Display the user's current tier prominently with a styled tier badge (tier name and a rank icon or color-coded visual that escalates in visual intensity as the tier increases). Show the weekly completion percentage used for the last evaluation and the advancement thresholds (e.g., ≥70% = advance, ≥40% = hold, <40% = drop). Include a 'Evaluate This Week' button that calls `evaluateAndAdvanceTier` and refreshes the displayed tier. Add a Settings link to the app's navigation bar (both desktop header and mobile bottom nav).",
      "reqIds": [
        "REQ-12"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-small-current-tier-badge-or-label-to-the-progress-screen-showing-the-user-s-tier-name-fetched-via-getusertier-so-users-can-see-their-rank-alongside-their-weekly-stats-without-navigating-to-settings",
      "title": "Add a small current tier badge or label to the Progress screen, showing the user's tier name fetched via `getUserTier`, so users can see their rank alongside their weekly stats without navigating to Settings.",
      "reqIds": [
        "REQ-13"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-react-query-hook-useusertier-in-frontend-src-hooks-usequeries-ts-that-calls-the-backend-getusertier-function-and-a-mutation-hook-useevaluatetier-that-calls-evaluateandadvancetier-and-invalidates-the-tier-query-on-success",
      "title": "Add a React Query hook `useUserTier` in `frontend/src/hooks/useQueries.ts` that calls the backend `getUserTier` function, and a mutation hook `useEvaluateTier` that calls `evaluateAndAdvanceTier` and invalidates the tier query on success.",
      "reqIds": [
        "REQ-14"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-browser-based-web-push-notifications-on-the-frontend-when-a-logged-in-user-grants-notification-permission-schedule-a-repeating-local-notification-via-the-notifications-api-and-a-service-worker-with-a-periodic-alarm-or-settimeout-based-scheduler-that-fires-every-6-hours-while-the-browser-pwa-is-running-or-backgrounded-each-notification-should-include-a-reminder-message-to-complete-their-daily-workout-and-a-motivational-quote-fetched-from-the-backend-s-existing-random-motivational-message-endpoint",
      "title": "Implement browser-based Web Push notifications on the frontend. When a logged-in user grants notification permission, schedule a repeating local notification (via the Notifications API and a Service Worker with a periodic alarm or setTimeout-based scheduler) that fires every 6 hours while the browser/PWA is running or backgrounded. Each notification should include a reminder message to complete their daily workout and a motivational quote fetched from the backend's existing random motivational message endpoint.",
      "reqIds": [
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-notification-opt-in-opt-out-toggle-in-the-settings-screen-when-the-user-enables-notifications-request-browser-notification-permission-and-start-the-6-hour-reminder-schedule-when-disabled-cancel-any-scheduled-notifications-persist-the-user-s-notification-preference-using-the-existing-notificationsenabled-field-in-the-userprofile-backend",
      "title": "Add a notification opt-in/opt-out toggle in the Settings screen. When the user enables notifications, request browser notification permission and start the 6-hour reminder schedule. When disabled, cancel any scheduled notifications. Persist the user's notification preference using the existing `notificationsEnabled` field in the UserProfile backend.",
      "reqIds": [
        "REQ-16"
      ],
      "version": 1
    },
    {
      "id": "feature-in-frontend-public-sw-js-change-the-repeating-notification-interval-from-every-6-hours-6-60-60-1000-ms-to-every-4-hours-4-60-60-1000-ms-update-the-setinterval-call-and-any-related-comments-or-constants-that-reference-the-6-hour-schedule",
      "title": "In `frontend/public/sw.js`, change the repeating notification interval from every 6 hours (6 * 60 * 60 * 1000 ms) to every 4 hours (4 * 60 * 60 * 1000 ms). Update the setInterval call and any related comments or constants that reference the 6-hour schedule.",
      "reqIds": [
        "REQ-17"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-schedule-page-frontend-src-pages-schedule-tsx-so-that-when-a-user-creates-or-edits-a-workout-entry-the-workout-details-section-renders-as-a-dynamic-list-of-set-row-inputs-instead-of-a-single-textarea-each-row-has-a-text-input-for-the-set-description-e-g-3x10-bench-press-users-can-add-new-rows-with-an-add-set-button-and-remove-existing-rows-with-a-delete-trash-icon-per-row-on-save-the-rows-are-persisted-to-the-backend-as-structured-set-rows-via-the-updated-mutation-hook",
      "title": "Update the Schedule page (`frontend/src/pages/Schedule.tsx`) so that when a user creates or edits a workout entry, the workout details section renders as a dynamic list of set-row inputs instead of a single textarea. Each row has a text input for the set description (e.g., '3x10 Bench Press'). Users can add new rows with an '+ Add Set' button and remove existing rows with a delete/trash icon per row. On save, the rows are persisted to the backend as structured set rows via the updated mutation hook.",
      "reqIds": [
        "REQ-19"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-today-s-workout-page-frontend-src-pages-todaysworkout-tsx-to-render-the-workout-s-set-rows-as-a-vertical-checklist-each-set-row-is-displayed-as-a-row-with-a-checkbox-and-its-description-text-checking-a-checkbox-marks-that-individual-set-row-as-completed-and-persists-the-change-to-the-backend-completed-rows-are-visually-distinguished-e-g-strikethrough-text-and-a-muted-checked-style-consistent-with-the-app-s-dark-fitness-theme-if-the-entry-has-no-set-rows-fall-back-to-displaying-the-plain-workout-details-text-as-before",
      "title": "Update the Today's Workout page (`frontend/src/pages/TodaysWorkout.tsx`) to render the workout's set rows as a vertical checklist. Each set row is displayed as a row with a checkbox and its description text. Checking a checkbox marks that individual set row as completed and persists the change to the backend. Completed rows are visually distinguished (e.g., strikethrough text and a muted/checked style consistent with the app's dark fitness theme). If the entry has no set rows, fall back to displaying the plain workout details text as before.",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-add-or-update-react-query-hooks-in-frontend-src-hooks-usequeries-ts-to-support-set-row-operations-a-mutation-to-toggle-a-single-set-row-s-completed-status-by-schedule-entry-id-and-row-id-and-ensure-the-existing-schedule-query-is-invalidated-refetched-after-the-toggle-so-the-ui-stays-in-sync",
      "title": "Add or update React Query hooks in `frontend/src/hooks/useQueries.ts` to support set-row operations: a mutation to toggle a single set row's completed status (by schedule entry ID and row ID), and ensure the existing schedule query is invalidated/refetched after the toggle so the UI stays in sync.",
      "reqIds": [
        "REQ-21"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Today's workout view auto-matched to current day",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Weekly workout schedule with editing (custom workout name, details, time)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Mark workout as completed button",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Motivational messages display (random from pool)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "User authentication (email sign-in) with user-specific workout data",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Progress tracking (completed workouts count / streak)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Create a backend data model and API for workout schedules. Each schedule entry should include: day of week (Monday–Sunday), workout name, workout details, time reminder, completed status, and owner identity. Support create, read, update, and delete operations, with data scoped per authenticated user.",
      "reqIds": [
        "REQ-1"
      ],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Create a backend data model and API for motivational messages. Seed at least 5 default messages. Support fetching a random motivational message.",
      "reqIds": [
        "REQ-2"
      ],
      "status": "pending"
    },
    {
      "id": "AR-9",
      "summary": "Create a backend API for user profiles. Each profile stores a display name and whether push notifications are enabled, keyed by the caller's principal. Support get and upsert operations.",
      "reqIds": [
        "REQ-3"
      ],
      "status": "pending"
    },
    {
      "id": "AR-10",
      "summary": "Weekly tier progression system: users advance through tiers (Dirt 1-3, Bronze 1-3, Silver 1-3, Platinum 1-3, Gold 1-3, Emerald 1-3, Diamond 1-3, Anti-matter) based on weekly schedule completion percentage. Display current tier in Settings screen.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-11",
      "summary": "Add a tier progression data model to the backend. Define a fixed ordered list of 22 tiers: Dirt 1, Dirt 2, Dirt 3, Bronze 1, Bronze 2, Bronze 3, Silver 1, Silver 2, Silver 3, Platinum 1, Platinum 2, Platinum 3, Gold 1, Gold 2, Gold 3, Emerald 1, Emerald 2, Emerald 3, Diamond 1, Diamond 2, Diamond 3, Anti-matter. Extend the UserProfile type to store the user's current tier index (defaulting to 0, i.e., Dirt 1) and a record of the last week the tier was evaluated (stored as a week number or ISO week string). Expose an API function `evaluateAndAdvanceTier` that, when called, computes the user's weekly completion rate (completed workout days out of 7), advances the tier by one step if completion is 100%, advances by one step if ≥ 70%, stays at the same tier if ≥ 40%, and drops one tier if below 40% (never below Dirt 1). Update the stored tier and last-evaluated week. Return the new tier name and index.",
      "reqIds": [
        "REQ-10"
      ],
      "status": "pending"
    },
    {
      "id": "AR-12",
      "summary": "Add a query function `getUserTier` to the backend that returns the caller's current tier name and index from their UserProfile without modifying it.",
      "reqIds": [
        "REQ-11"
      ],
      "status": "pending"
    },
    {
      "id": "AR-13",
      "summary": "AI workout generator: 'Don't have a workout?' section that suggests a workout regiment based on user goals, with option to auto-set it into their schedule",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-14",
      "summary": "Push notifications every 6 hours for users not actively in the app, reminding them to complete their daily workout along with a motivational quote",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-15",
      "summary": "Change notification reminder interval from every 6 hours to every 4 hours",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-16",
      "summary": "Workout description supports structured rows (sets/exercises) that can be individually checked off as completed during a workout session",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-17",
      "summary": "Extend the workout schedule backend data model so that each schedule entry's workout details field supports an array of structured set rows. Each set row must have a unique ID, a text description (e.g., '3x10 Bench Press'), and a completed boolean. Update the `WorkoutSchedule` type and all relevant CRUD API functions (`createScheduleEntry`, `updateScheduleEntry`, `getScheduleForUser`) to accept and return set rows. The existing plain-text `workoutDetails` field must remain backward-compatible (entries without set rows continue to work).",
      "reqIds": [
        "REQ-18"
      ],
      "status": "pending"
    }
  ],
  "gameProjectType": "none",
  "projectName": "Daily Grind",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}